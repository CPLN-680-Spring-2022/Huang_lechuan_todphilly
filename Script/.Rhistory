geom_sf(data = st_union(Vacantlots))+
geom_sf(aes(fill = q5(pct_vacant))) +
geom_sf(data = unionbuffer, fill = "transparent", color = "red")+
scale_fill_manual(values = c("#f0f9e8","#bae4bc"),
labels = qBr(Vacantlots, "TOD"),
name = "Boolean") +
labs(title = "Percentage of Vacant lot", subtitle = "DVRPC") +
mapTheme() +
theme(plot.title = element_text(size=22))
ggplot() +
geom_sf(data=TODtracts,
aes(colour = TOD)) +
scale_colour_manual(values = c("#ff8f1c", "#007dc3")) +
labs(title="Rail Stops in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=TODtracts,
aes(fill = TOD)) +
scale_colour_manual(values = c("#ff8f1c", "#007dc3")) +
labs(title="Rail Stops in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=TODtracts,
aes(fill = TOD)) +
labs(title="Rail Stops in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=TODtracts,
aes(fill = TOD, color = c("#f0f9e8","#bae4bc"))) +
labs(title="TOD tracks in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=TODtracts,
aes(fill = TOD, colour = c("#f0f9e8","#bae4bc"))) +
labs(title="TOD tracks in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=TODtracts,
aes(fill = TOD, colour = c("#f0f9e8"))) +
labs(title="TOD tracks in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=TODtracts,
aes(fill = TOD)) +
labs(title="TOD tracks in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=TODtracts) +
geom_sf(aes(fill = q5(TOD))) +
labs(title="TOD tracks in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=TODtracts,
aes(fill = TOD)) +
labs(title="TOD tracks in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=TODtracts,
aes(fill = TOD)) +
labs(title="TOD tracts in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
st_write(TODtracts, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/Tract_map_TOD_0208.shp")
TODyes <- filter(TODtracts, TOD == "TOD")
View(TODyes)
ggplot() +
geom_sf(data=TODyes,
aes(fill = TOD)) +
labs(title="TOD tracts in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=TODyes,
aes(fill = TOD)) +
labs(title="TOD tracts in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=TODyes,
aes(fill = TOD)) +
geom_sf(data=DVRPC_railstops,
aes(colour = type_sym),
show.legend = "point", size= 2) +
scale_colour_manual(values = c("#ff8f1c", "#007dc3", "#781d7e", "#005DAA", "#EF3E42","#00A5E3", "#EF3E42", "#0255a1","#5d9731")) +
labs(title="TOD tracts in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=TODyes,
aes(fill = TOD)) +
geom_sf(data=DVRPC_railstops,
aes(colour = type_sym),
show.legend = "point", size= 2) +
geom_sf(data = unionbuffer, fill = "transparent", color = "red")+
scale_colour_manual(values = c("#ff8f1c", "#007dc3", "#781d7e", "#005DAA", "#EF3E42","#00A5E3", "#EF3E42", "#0255a1","#5d9731")) +
labs(title="TOD tracts in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
st_write(TODyes, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TODtracts.shp")
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson") %>%
DVRPC_P+Rs <-
rbind(
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson"))
DVRPC_P+Rs <-
rbind(
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson") %>%
select(facility, type, line, service, county, state))
DVRPC_P <-
rbind(
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson") %>%
select(facility, type, line, service, county, state))
View(DVRPC_P)
DVRPC_P <-
rbind(
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson") %>%
select(facility, type, line, service, county, state, st_area(shape)))
DVRPC_P <-
rbind(
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson") %>%
select(facility, type, line, service, county, state, "st_area(shape)"))
DVRPC_P <-
rbind(
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson") %>%
select())
View(DVRPC_P)
DVRPC_P <-
rbind(
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson") %>%
select(facility, type, line, service, county, state))
DVRPC_P <-
rbind(
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson") %>%
select(facility, type, line, service, county, state))%>%
st_transform(st_crs(Study.sf))  %>%
mutate(area = st_area())
DVRPC_P <-
rbind(
st_read("https://opendata.arcgis.com/datasets/45e0360128aa40448303c6458ca1a075_0.geojson") %>%
select(facility, type, line, service, county, state))%>%
st_transform(st_crs(Study.sf))  %>%
mutate(area = st_area(DVRPC_P))
View(DVRPC_P)
typeof(DVRPC_P$area)
DVRPC_Parcel <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/Greater_Philadelphia_2015_Land_Use/Greater_Philadelphia_2015_Land_Use.shp")
DVRPC_Parcel <-
rbind(
st_read("https://arcgis.dvrpc.org/portal/rest/services/Planning/DVRPC_LandUse_2015/FeatureServer/0/query?outFields=*&where=1%3D1") %>%
select(geoid, lu15dev, mixeduse, lu15subn, state_name, co_name, mun_name, acres))%>%
st_transform(st_crs(Study.sf))
DVRPC_Parcel <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/Greater_Philadelphia_2015_Land_Use.shp.shp")
DVRPC_Parcel <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/Greater_Philadelphia_2015_Land_Use.shp")
TOD_parcel <- st_join(TODyes, DVRPC_Parcel, join = st_intersects, left = TRUE, largest = FALSE)
DVRPC_Parcel <- DVRPC_Parcel%>%
st_transform(st_crs(Study.sf))
TOD_parcel <- st_join(TODyes, DVRPC_Parcel, join = st_intersects, left = TRUE, largest = FALSE)
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(dataDVRPC_Parcel) +
labs(caption = "Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=DVRPC_Parcel) +
labs(caption = "Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=DVRPC_Parcel) +
labs(caption = "Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=st_union(DVRPC_Parcel)) +
labs(caption = "Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=st_union(TOD_parcel)) +
labs(caption = "Figure xx") +
mapTheme()
st_write(TOD_parcel, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_parcels.shp")
View(DVRPC_Parcel)
View(TOD_parcel)
TOD_parcel <- st_join(TODyes, DVRPC_Parcel, join = st_contains, left = TRUE, largest = FALSE)
View(TOD_parcel)
TOD_parcel <- st_join(TODyes, DVRPC_Parcel, join = st_contains)
View(TOD_parcel)
TOD_parcel <- st_join(DVRPC_Parcel, TODyes, join = st_contains)
View(TOD_parcel)
TOD_parcel <- TOD_parcel%>%
dplyr::select(-GEOID, NAME, TotalPp, White, Black, Asian, Hspnc_L, Pvrty_r, MedIncm, own_hsn, rt_hwng, TotalHH, Totallt, Vcnt_lt, State, County, TOD)
View(TOD_parcel)
TOD_parcel <- TOD_parcel%>%
dplyr::select(-GEOID, -NAME, -TotalPp, -White, -Black, -Asian, -Hspnc_L, -Pvrty_r, -MedIncm, -own_hsn, -rt_hwng, -TotalHH, -Totallt, -Vcnt_lt, -State, -County, -TOD)
TOD_parcel <- TOD_parcel%>%
dplyr::select(-NAME, -TotalPp, -White, -Black, -Asian, -Hspnc_L, -Pvrty_r, -MedIncm, -own_hsn, -rt_hwng, -TotalHH, -Totallt, -Vcnt_lt, -State, -County, -TOD)
View(TOD_parcel)
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=st_union(TOD_parcel)) +
labs(caption = "Figure xx") +
mapTheme()
st_write(TOD_parcel, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_parcels.shp")
gc()
st_write(TOD_parcel, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_parcels.shp")
TOD_parcel2 <- st_collection_extract(TOD_parcel, "POLYGON")
st_write(TOD_parcel2, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_parcels.shp")
TOD_parcel2 <- TOD_parcel%>%
st_sf()
st_write(TOD_parcel2, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_parcels.shp")
TOD_parcel <- st_join(DVRPC_Parcel, TODyes, join = st_contains)%>%
dplyr::select(-GEOID, -NAME, -TotalPp, -White, -Black, -Asian, -Hspnc_L, -Pvrty_r, -MedIncm, -own_hsn, -rt_hwng, -TotalHH, -Totallt, -Vcnt_lt, -State, -County, -TOD)%>%
st_sf()
st_write(TOD_parcel, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_parcels.shp")
View(TOD_parcel)
st_write(TOD_parcel, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_parcels.csv")
library(tidycensus)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(rgdal)
library(sf)
root.dir = "https://raw.githubusercontent.com/urbanSpatial/Public-Policy-Analytics-Landing/master/DATA/"
source("https://raw.githubusercontent.com/urbanSpatial/Public-Policy-Analytics-Landing/master/functions.r")
census_api_key("3050a770b2aedfa128dd2ccc6ca8b8524fccc775", overwrite = TRUE)
palette5 <- c("#25CB10", "#5AB60C", "#8FA108",   "#C48C04", "#FA7800")
TODyes <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/Tract_map_TOD_0208.shp")
Study.sf <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/Tract_map_0203.shp")
Study.sf <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/Tract_map_0203.shp")
Study.sf <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/Tidycensus/Tract_map_0203.shp")
Study.sf <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_tracts.shp")
Study.sf <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TODtracts.shp")
View(TODyes)
DVRPC_railstops <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/Transitstations.shp")
#BSL, MFL, NHSL, ATLANTIC, NEC, RIVERLINE, PATCO, SEPTA, Trolley
ggplot() +
geom_sf(data=Study.sf) +
geom_sf(data=DVRPC_railstops,
aes(colour = type_sym),
show.legend = "point", size= 2) +
scale_colour_manual(values = c("#ff8f1c", "#007dc3", "#781d7e", "#005DAA", "#EF3E42","#00A5E3", "#EF3E42", "#0255a1","#5d9731")) +
labs(title="Rail Stops in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
TODyes <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TODtracts.shp")
Study.sf <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/Tract_map_TOD_0208.shp")
#BSL, MFL, NHSL, ATLANTIC, NEC, RIVERLINE, PATCO, SEPTA, Trolley
ggplot() +
geom_sf(data=Study.sf) +
geom_sf(data=DVRPC_railstops,
aes(colour = type_sym),
show.legend = "point", size= 2) +
scale_colour_manual(values = c("#ff8f1c", "#007dc3", "#781d7e", "#005DAA", "#EF3E42","#00A5E3", "#EF3E42", "#0255a1","#5d9731")) +
labs(title="Rail Stops in DVRPC",
subtitle="Philadelphia, PA",
caption="Figure xx") +
mapTheme()
DVRPC_Parcel <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/Greater_Philadelphia_2015_Land_Use.shp")%>%
st_transform(st_crs(Study.sf))
View(Study.sf)
TOD_parcel <- st_join(DVRPC_Parcel, TODyes, join = st_within)%>%
dplyr::select(-GEOID, -NAME, -TotalPp, -White, -Black, -Asian, -Hspnc_L, -Pvrty_r, -MedIncm, -own_hsn, -rt_hwng, -TotalHH, -Totallt, -Vcnt_lt, -State, -County, -TOD)%>%
st_sf()
sf_use_s2(FALSE)
TOD_parcel <- st_join(DVRPC_Parcel, TODyes, join = st_within)%>%
dplyr::select(-GEOID, -NAME, -TotalPp, -White, -Black, -Asian, -Hspnc_L, -Pvrty_r, -MedIncm, -own_hsn, -rt_hwng, -TotalHH, -Totallt, -Vcnt_lt, -State, -County, -TOD)%>%
st_sf()
TOD_parcel <- st_join(DVRPC_Parcel, TODyes, join = st_contains)%>%
dplyr::select(-GEOID, -NAME, -TotalPp, -White, -Black, -Asian, -Hspnc_L, -Pvrty_r, -MedIncm, -own_hsn, -rt_hwng, -TotalHH, -Totallt, -Vcnt_lt, -State, -County, -TOD)%>%
st_sf()
TOD_parcel <- st_join(DVRPC_Parcel, TODyes, join = st_contains)%>%
st_sf()
TOD_parcel <- st_join(DVRPC_Parcel, TODyes, join = st_within)%>%
st_sf()
TOD_parcel <- st_filter(DVRPC_Parcel, TODyes, join = st_within)%>%
st_sf()
dplyr::select(-GEOID, -NAME, -TotalPp, -White, -Black, -Asian, -Hspnc_L, -Pvrty_r, -MedIncm, -own_hsn, -rt_hwng, -TotalHH, -Totallt, -Vcnt_lt, -State, -County, -TOD)%>%
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=st_union(TOD_parcel)) +
labs(caption = "Figure xx") +
mapTheme()
dplyr::select(-GEOID, -NAME, -TotalPp, -White, -Black, -Asian, -Hspnc_L, -Pvrty_r, -MedIncm, -own_hsn, -rt_hwng, -TotalHH, -Totallt, -Vcnt_lt, -State, -County, -TOD)%>%
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=st_union(TOD_parcel)) +
labs(caption = "Figure xx") +
mapTheme()
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=st_union(TOD_parcel)) +
labs(caption = "Figure xx") +
mapTheme()
sf_use_s2(TRUE)
DVRPC_Parcel <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/Greater_Philadelphia_2015_Land_Use.shp")%>%
st_transform(st_crs(Study.sf))
TOD_parcel <- st_filter(DVRPC_Parcel, TODyes, join = st_within)%>%
st_sf()
DVRPC_Parcel <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/Greater_Philadelphia_2015_Land_Use.shp")%>%
st_transform(st_crs(Study.sf))%>%
st_segmentize()
DVRPC_Parcel <- DVRPC_Parcel%>%
st_segmentize()
DVRPC_Parcel <- DVRPC_Parcel%>%
s2_rebuild()
library(s2)
DVRPC_Parcel <- DVRPC_Parcel%>%
s2_rebuild()
TOD_parcel <- st_filter(st_centroid(DVRPC_Parcel), TODyes, join = st_within)%>%
st_sf()
sf_use_s2(FALSE)
TOD_parcel <- st_filter(DVRPC_Parcel, TODyes, join = st_within)%>%
st_sf()
TOD_parcel2 <- st_filter(st_centroid(DVRPC_Parcel), TODyes, join = st_within)%>%
st_sf()
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=st_union(TOD_parcel2)) +
labs(caption = "Figure xx") +
mapTheme()
st_write(TOD_parcel2, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_parcels_point.shp")
ggplot() +
geom_sf(data=st_union(Study.sf)) +
geom_sf(data=st_union(TOD_parcel)) +
labs(caption = "Figure xx") +
mapTheme()
View(TOD_parcel2)
view(DVRPC_Parcel$lu15subn)
count_(DVRPC_Parcel)
count_(DVRPC_Parcel$lu15subn)
library(plyr)
count(DVRPC_Parcel$lu15subn)
Landuse_overall <- count(DVRPC_Parcel$lu15subn)
Landuse_todbuffer <- count(TOD_parcel2$lu15subn)
View(Landuse_overall)
View(Landuse_todbuffer)
Landuse_com <- join(Landuse_overall, Landuse_todbuffer)
View(Landuse_com)
Landuse_com <- cbind(Landuse_overall, Landuse_todbuffer)
sum(Landuse_overall$freq)
sum(Landuse_todbuffer$freq)
Landuse_overall <- count(DVRPC_Parcel$lu15subn)%>%
mutate(pct = freq/334759)
Landuse_todbuffer <- count(TOD_parcel2$lu15subn)%>%
mutate(pct = freq/41926)
View(Landuse_overall)
Landuse_com <- merge(Landuse_overall, Landuse_todbuffer, by="x", all = T)
View(Landuse_com)
st_write(TOD_parcel, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/TOD_parcels_polygon.shp")
Landuse_com <- merge(Landuse_overall, Landuse_todbuffer, by="x", all = T)%>%
dplyr::select(-freq.x, freq.y)%>%
rename(pct_inTotal = pct.x, pct_inTOD = pct.y)
Landuse_com <- Landuse_com%>%
dplyr::select(-freq.x, freq.y)%>%
rename(pct_inTotal = pct.x, pct_inTOD = pct.y)
Landuse_com <- Landuse_com%>%
dplyr::select(-freq.x, freq.y)%>%
rename(pct.x = pct_inTotal, pct.y = pct_inTOD)
Landuse_com <- Landuse_com%>%
dplyr::select(-freq.x, -freq.y)%>%
rename(pct_inTotal = pct.x, pct_inTOD = pct.y)
Landuse_com <- Landuse_com%>%
dplyr::select(-freq.x, -freq.y)%>%
rename(pct_inTotal = pct.x)
Landuse_com <- Landuse_com%>%
dplyr::select(-freq.x, -freq.y)%>%
dplyr::rename(pct_inTotal = pct.x, pct_inTOD = pct.y)
View(Landuse_com)
st_write(Landuse_com, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/Landuse_existingTOD_comparison.csv")
View(DVRPC_Parcel)
#Comparison by size
landusesize_total <- aggregate(DVRPC_Parcel$Shape__Are, list(DVRPC_Parcel$lu15subn), FUN=sum)
View(landusesize_total)
sum(landusesize_total$x)
#Comparison by size
landusesize_total <- aggregate(DVRPC_Parcel$Shape__Are, list(DVRPC_Parcel$lu15subn), FUN=sum)%>%
dplyr::rename(x = Area)%>%
mutate(pct = Area/9871990560)
#Comparison by size
landusesize_total <- aggregate(DVRPC_Parcel$Shape__Are, list(DVRPC_Parcel$lu15subn), FUN=sum)%>%
dplyr::rename(x = Area)%>%
mutate(pct = x/9871990560)
#Comparison by size
landusesize_total <- aggregate(DVRPC_Parcel$Shape__Are, list(DVRPC_Parcel$lu15subn), FUN=sum)%>%
mutate(pct = x/9871990560)%>%
dplyr::rename(x = Area)
#Comparison by size
landusesize_total <- aggregate(DVRPC_Parcel$Shape__Are, list(DVRPC_Parcel$lu15subn), FUN=sum)%>%
mutate(pct = x/9871990560)
#Comparison by size
landusesize_total <- aggregate(DVRPC_Parcel$Shape__Are, list(DVRPC_Parcel$lu15subn), FUN=sum)%>%
mutate(pct_total = x/9871990560)
sum(TOD_parcel2$Shape__Are)
landusesize_tod <- aggregate(TOD_parcel2$Shape__Are, list(TOD_parcel2$lu15subn), FUN=sum)%>%
mutate(pct_total = x/396931277)
landusesize_tod <- aggregate(TOD_parcel2$Shape__Are, list(TOD_parcel2$lu15subn), FUN=sum)%>%
mutate(pct_tod = x/396931277)
View(landusesize_tod)
View(landusesize_total)
View(landusesize_tod)
Landuse_sizecom <- merge(landusesize_total, landusesize_tod, by="Group.1", all = T)
View(Landuse_sizecom)
Landuse_com <- Landuse_com%>%
dplyr::select(x.x, x.y)%>%
dplyr::rename(landuse = Group.1)
Landuse_com <- Landuse_com%>%
dplyr::select(-x.x, -x.y)%>%
dplyr::rename(landuse = Group.1)
Landuse_sizecom <- Landuse_sizecom%>%
dplyr::select(-x.x, -x.y)%>%
dplyr::rename(landuse = Group.1)
st_write(Landuse_com, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/Landuse_existingTOD_sizecomparison.csv")
size <- desc(Landuse_sizecom$pct_tod)
desc(Landuse_sizecom$pct_tod)
size <- arrange(desc(Landuse_sizecom$pct_tod))
size <- Landuse_sizecom%>%
arrange(desc(Landuse_sizecom$pct_tod))
View(size)
size <- Landuse_sizecom%>%
arrange(desc(Landuse_sizecom$pct_tod))%>%
head(, 11)
View(size)
size <- Landuse_sizecom%>%
arrange(desc(Landuse_sizecom$pct_tod))%>%
head(Landuse_sizecom, 11)
head(Landuse_sizecom, 11)
head(Landuse_sizecom, 20)
View(size)
size <- Landuse_sizecom%>%
arrange(desc(Landuse_sizecom$pct_tod))
View(size)
head(size, 20)
forggplot <- as.dataframe(head(size, 20))
forggplot <- as.data.frame(head(size, 20))
View(forggplot)
ggplot(forggplot, aes(fill = Var1, y = pct.total, x = landuse)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_discrete(name  = "Landuse Comparison",
labels=c("Total", "TOD_area")) +
ylab("Pct %") +
theme_bw()
ggplot(forggplot, aes(fill = Var1, y = pct_total, x = landuse)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_discrete(name  = "Landuse Comparison",
labels=c("Total", "TOD_area")) +
ylab("Pct %") +
theme_bw()
ggplot(forggplot, aes(y = pct_total, x = landuse)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_discrete(name  = "Landuse Comparison",
labels=c("Total", "TOD_area")) +
ylab("Pct %") +
theme_bw()
ggplot(forggplot, aes(y = cbind(pct_total, pct_tod), x = landuse)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_discrete(name  = "Landuse Comparison",
labels=c("Total", "TOD_area")) +
ylab("Pct %") +
theme_bw()
View(forggplot)
ggplot(forggplot) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_discrete(name  = "Landuse Comparison",
labels=c("Total", "TOD_area")) +
ylab("Pct %") +
theme_bw()
ggplot(forggplot, aes(fill = variable, y = pct_total, x = landuse)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_discrete(name  = "Landuse Comparison",
labels=c("Total", "TOD_area")) +
ylab("Pct %") +
theme_bw()
ggplot(forggplot, aes(y = c(forggplot$pct_total, forggplot$pct_tod), x = landuse)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_discrete(name  = "Landuse Comparison",
labels=c("Total", "TOD_area")) +
ylab("Pct %") +
theme_bw()
plot(forggplot)
barplot(forggplot)
st_write(forggplot, "C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/cleaned_data/ggplot.csv")
DVRPC_TOD <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/DVRPC_TOD/TOD_Opportunities.shp")
library(sf)
DVRPC_TOD <- st_read("C:/Users/mnxan/OneDrive/Documents/GitHub/Huang_lechuan_todphilly/raw_data/DVRPC_TOD/TOD_Opportunities.shp")
View(DVRPC_TOD)
